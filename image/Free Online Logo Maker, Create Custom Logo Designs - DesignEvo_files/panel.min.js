var inAppClick=false;function stopDefault(e){if(e&&e.preventDefault){e.preventDefault()}else{window.event.returnValue=false}return false}function updateUserBtnPosition(expand){jQuery("#btSignUp").css({marginTop:expand?"25px":"14px"});jQuery("#btUser").css({marginTop:expand?"36px":"25px"})}if(!window.bannerAnimationCallbacks){window.bannerAnimationCallbacks=new Array}window.bannerAnimationCallbacks.push(updateUserBtnPosition);function commonCurrentLanguageHref(){var url=document.location.href;var tag="/";if(url.indexOf("/cn/")!=-1)tag="cn/";else if(url.indexOf("/tw/")!=-1)tag="tw/";else if(url.indexOf("/de/")!=-1)tag="de/";else if(url.indexOf("/es/")!=-1)tag="es/";else if(url.indexOf("/pt/")!=-1)tag="pt/";else if(url.indexOf("/jp/")!=-1)tag="jp/";else if(url.indexOf("/fr/")!=-1)tag="fr/";return tag}var LocalFunc={_:function(val){return localTipTitle[val]}};window.onkeydown=function(e){if(e.keyCode==27){PanelFunc.closeModal()}};window.fbAsyncInit=function(){FB.init({appId:"348667772210542",xfbml:true,version:"v2.11"})};(function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(d.getElementById(id)){return}js=d.createElement(s);js.id=id;js.src="//connect.facebook.net/en_US/sdk.js";fjs.parentNode.insertBefore(js,fjs)})(document,"script","facebook-jssdk");var modalName=null;var PanelFunc={onClick:function(object,callback){jQuery(object).click(callback())},closeModal:function(){jQuery(".designevo-modal").hide();jQuery("#modal_mask").hide();this.resetPanels();modalName=null;if(typeof grecaptcha!=="undefined"&&grecaptcha){grecaptcha.reset(window.gcSignUp);grecaptcha.reset(window.gcSignIn)}},showModal:function(name){this.resetPanels();jQuery("#modal_mask").css({height:jQuery(document).height(),width:jQuery(document).width()}).show();jQuery("#"+name).find("input[type='text']").each(function(){if(jQuery(this).val()==""){jQuery(this).val("")}});jQuery("#"+name).css({"z-index":65556}).show();modalName=name},resetPanels:function(){PopupFunc.showUsernameError(0,false);PopupFunc.showUsernameError(1,false);PopupFunc.showUsername1Error(false);PopupFunc.showPswdError(0,false);PopupFunc.showPswdError(1,false);jQuery("input[name='username']")[1].value="";jQuery("input[name='password']")[1].value="";jQuery("input[name='username']")[0].value="";jQuery("input[name='username1']")[0].value="";jQuery("input[name='password']")[0].value="";jQuery("div[name='signuptip']")[0].style.display="none";jQuery("div[name='signintip']")[0].style.display="none"},modalVisible:function(name){if(jQuery("#"+name).is(":visible")&&jQuery("#modal_mask").is(":visible")){return true}return false},closeLoginSignup:function(){if(jQuery("#signin").is(":visible"))jQuery("#signin").hide();if(jQuery("#signup").is(":visible"))jQuery("#signup").hide();jQuery("#modal_mask").hide()},signUpToExport:function(type){var title1=LocalFunc._("loginSaveTitle");var title2=LocalFunc._("signupSaveTitle");switch(type){case"share":{title1=LocalFunc._("loginShareTitle");title2=LocalFunc._("signupShareTitle");break}case"print":{title1=LocalFunc._("loginPrintTitle");title2=LocalFunc._("signupPrintTitle");break}default:break}jQuery("span[name='signupTitle']")[0].innerHTML=title2;jQuery("span[name='loginTitle']")[0].innerHTML=title1;this.showSignUpPane();inAppClick=false},signIn:function(e){stopDefault(e);this.closeLoginSignup();this.showSignInPane()},showSignInPane:function(){jQuery("div[name='signintip']")[0].style.display="none";jQuery("span[name='usernametip']")[0].style.display="none";jQuery("span[name='passwordtip']")[0].style.display="none";this.showModal("signin");var jp=CookieFunc.initLogin();AjaxPost.ajaxCheckLogin()},showSignUpPane:function(){jQuery("div[name='signuptip']")[0].style.display="none";jQuery("span[name='usernametip']")[1].style.display="none";jQuery("span[name='passwordtip']")[1].style.display="none";this.showModal("signup");var jp=CookieFunc.initLogin();AjaxPost.ajaxCheckLogin()},signUp:function(event){stopDefault(event);this.closeLoginSignup();this.showSignUpPane("signup")},signinClick:function(){jQuery("span[name='signupTitle']")[0].innerHTML=LocalFunc._("signupTitle");jQuery("span[name='loginTitle']")[0].innerHTML=LocalFunc._("loginTitle");this.showSignInPane();if(inAppClick){inAppClick=false;return}},signupClick:function(){jQuery("span[name='signupTitle']")[0].innerHTML=LocalFunc._("signupTitle");jQuery("span[name='loginTitle']")[0].innerHTML=LocalFunc._("loginTitle");this.showSignUpPane();if(inAppClick){inAppClick=false;return}},confirmAccount:function(){this.closeModal();jQuery("#emailService")[0].click()},showLoginBtn:function(){jQuery("#unlogin").removeClass("u-hide");jQuery("#logged").addClass("u-hide")},hideLoginBtn:function(){jQuery("#unlogin").addClass("u-hide");jQuery("#logged").removeClass("u-hide")}};var googleUser={};var startGoogle=function(){gapi.load("auth2",function(){auth2=gapi.auth2.init({client_id:"385660717962-nlcuj8f80042ufvvhk6br4t5apitmhhk.apps.googleusercontent.com",cookiepolicy:"single_host_origin"});attachGoogleSignin(jQuery("button[name='btnGoogle']")[0]);attachGoogleSignin(jQuery("button[name='btnGoogle']")[1])})};function attachGoogleSignin(element){auth2.attachClickHandler(element,{},function(googleUser){loginGoogleFunc.onSignIn(googleUser)},function(error){var idx=0;if(PanelFunc.modalVisible("signup")){idx=1}var progress=jQuery("div[name='gl_progress']")[idx];jQuery(progress).hide();jQuery(element).html(loginGoogleFunc.glBtnHtml)})}var loginGoogleFunc={glBtnHtml:null,loginClick:function(e){stopDefault(e);var idx=0;if(PanelFunc.modalVisible("signup")){idx=1}var progress=jQuery("div[name='gl_progress']")[idx];var targetBtn=e.target;if(!this.glBtnHtml)this.glBtnHtml=jQuery(targetBtn).html();jQuery(progress).show();jQuery(targetBtn).html("")},onSignIn:function(googleUser){var id_token=googleUser.getAuthResponse().id_token;AjaxPost.ajaxConnectGoogle(id_token)},signOut:function(){try{var auth2=gapi.auth2.getAuthInstance();auth2.signOut().then(function(){})}catch(e){}}};var loginFacebookFunc={loginClick:function(e){stopDefault(e);var idx=0;if(PanelFunc.modalVisible("signup")){idx=1}var progress=jQuery("div[name='fb_progress']")[idx];var oldHtml=jQuery(e.target).html();var targetBtn=e.target;jQuery(progress).show();jQuery(targetBtn).html("");FB.login(function(response){if(response.status==="connected"){this.handleFacebookConnected(response,oldHtml)}else if(response.status==="not_authorized"){jQuery(progress).hide();jQuery(targetBtn).html(oldHtml)}else{jQuery(progress).hide();jQuery(targetBtn).html(oldHtml)}}.bind(this),{scope:"public_profile,email"})},handleFacebookConnected:function(resp,oldHtml){var token=resp.authResponse.accessToken;AjaxPost.ajaxConnectFacebook(token,oldHtml)},statusChangeCallback:function(response){if(response.status==="connected"){this.handleFacebookConnected(response)}else if(response.status==="not_authorized"){}else{}},checkLoginState:function(){FB.getLoginStatus(function(response){this.statusChangeCallback(response)}.bind(this))}};var CookieFunc={initLogin:function(){if("true"===this.getCookie("designevo_remember")){var usertoken=this.getCookie("designevo_usertoken");if(usertoken){jQuery.ajax({type:"POST",url:"/index.php?option=com_designevo&task=user.rememberState",data:{token:usertoken},success:function(response){response=response.substring(response.lastIndexOf("{'"));var obj=new Function("return"+response)();if(obj.result==true&&PanelFunc.modalVisible("signin")){var doc=window.parent.document;jQuery("input[name='username']")[0].value=obj.username;jQuery("input[name='password']")[0].value=obj.pswd;jQuery("#remember").addClass("designevo-checkbox-btn-checked")}}})}}},setCookie:function(name,value){var Days=10;var exp=new Date;exp.setTime(exp.getTime()+Days*24*60*60*1e3);document.cookie=name+"="+escape(value)+";expires="+exp.toGMTString()},getCookie:function(name){var arr,reg=new RegExp("(^| )"+name+"=([^;]*)(;|$)");if(arr=document.cookie.match(reg))return unescape(arr[2]);else return null},delCookie:function(name){var exp=new Date;exp.setTime(exp.getTime()-1);var cval=this.getCookie(name);if(cval!=null)document.cookie=name+"="+cval+";expires="+exp.toGMTString()}};var PopupFunc={checkEmail:function(email){if(email.indexOf(".")==-1)return false;var regex=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;return regex.test(email)},keyLogin:function(e){e=e?e:window.event;if(e.keyCode==13){jQuery("button[name='signinSubmit']")[0].click()}},keyRegister:function(e){e=e?e:window.event;if(e.keyCode==13){jQuery("button[name='signupSubmit']")[0].click()}},validateSignIn:function(){var doc=window.document;var signintip=jQuery("div[name='signintip']")[0];var usernametip=jQuery("span[name='usernametip']")[0];var passwordtip=jQuery("span[name='passwordtip']")[0];var height=395;var username=jQuery("input[name='username']")[0];var reMail=true;var mail=username.value;mail=mail.replace(/(^\s*)|(\s*$)/g,"");username.value=mail;if(mail.length==0){usernametip.innerHTML=LocalFunc._("mailEmptyTip");reMail=false;height+=2}else if(mail.length>64){usernametip.innerHTML=LocalFunc._("mailLengthTip");reMail=false;height+=2}else if(!this.checkEmail(mail)){usernametip.innerHTML=LocalFunc._("mailWrongTip");reMail=false;height+=2}var password=jQuery("input[name='password']")[0];var rePswd=true;var pswd=password.value;pswd=pswd.replace(/(^\s*)|(\s*$)/g,"");password.value=pswd;var length=pswd.length;if(length==0){passwordtip.innerHTML=LocalFunc._("pswdEmptyTip");rePswd=false;height+=3}else if(length<6||length>64){passwordtip.innerHTML=LocalFunc._("pswdLengthTip");rePswd=false;height+=18}if(reMail&&rePswd)return true;signintip.style.display="none";this.showUsernameError(0,!reMail);this.showPswdError(0,!rePswd);return false},validateSignUp:function(){var doc=window.parent.document;var signuptip=jQuery("div[name='signuptip']")[0];var usernametip=jQuery("span[name='usernametip']")[1];var usernametip1=jQuery("span[name='usernametip1']")[0];var passwordtip=jQuery("span[name='passwordtip']")[1];var height=414;var username=jQuery("input[name='username']")[1];var reMail=true;var mail=username.value;mail=mail.replace(/(^\s*)|(\s*$)/g,"");username.value=mail;if(mail.length==0){usernametip.innerHTML=LocalFunc._("mailEmptyTip");reMail=false}else if(mail.length>64){usernametip.innerHTML=LocalFunc._("mailLengthTip");reMail=false}else if(!this.checkEmail(mail)){usernametip.innerHTML=LocalFunc._("mailWrongTip");reMail=false}var username1=jQuery("input[name='username1']")[0];var reConfirm=true;var mail1=username1.value;if(mail1.length==0){usernametip1.innerHTML=LocalFunc._("mailWrongTip");reConfirm=false}else if(mail!==mail1){usernametip1.innerHTML=LocalFunc._("mailConfirmTip");reConfirm=false}var password=jQuery("input[name='password']")[1];var rePswd=true;var pswd=password.value;pswd=pswd.replace(/(^\s*)|(\s*$)/g,"");password.value=pswd;var length=pswd.length;if(length==0){passwordtip.innerHTML=LocalFunc._("pswdEmptyTip");rePswd=false;height+=2}else if(length<6||length>64){passwordtip.innerHTML=LocalFunc._("pswdLengthTip");rePswd=false;height+=20}if(!reMail&&!reConfirm&&!rePswd)height+=2;else if(reMail&&reConfirm&&rePswd)return true;signuptip.style.display="none";this.showUsernameError(1,!reMail);this.showUsername1Error(!reConfirm);this.showPswdError(1,!rePswd);return false},showUsernameError:function(idx,flag){var usernametip=jQuery("span[name='usernametip']")[idx];var username=jQuery("input[name='username']")[idx];if(!flag){usernametip.style.display="none"}else{usernametip.style.display="block"}},menuClick:function(){jQuery("#account_menu").hide()},showUsername1Error:function(flag){var usernametip1=jQuery("span[name='usernametip1']")[0];var username1=jQuery("input[name='username1']")[0];if(!flag){usernametip1.style.display="none"}else{usernametip1.style.display="block"}},showPswdError:function(idx,flag){var passwordtip=jQuery("span[name='passwordtip']")[idx];var password=jQuery("input[name='password']")[idx];if(!flag){passwordtip.style.display="none"}else{passwordtip.style.display="block"}}};